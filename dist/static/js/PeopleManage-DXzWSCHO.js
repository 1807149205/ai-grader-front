import{d as E,r as U,a as S,o as W,a2 as k,c as a,Z as n,B as X,$ as r,_ as c,G as u,Y as b,F as x,a3 as z,a1 as $,a0 as G}from"./@vue-DQ8ziMgL.js";import{r as g}from"./http-DtPS8xaZ.js";import{d as ee}from"./dayjs-Ct77qKTJ.js";import{u as ae}from"./index-C0EMKaFY.js";import{a as v,M as te}from"./ant-design-vue-BsThXQyf.js";import"./axios-NIGUFBhG.js";import"./pinia-uvDSw88s.js";import"./vue-router-Bnt47Z6A.js";import"./@babel-Bq4_u9L9.js";import"./@ant-design-DeQVn8T2.js";import"./@ctrl-DOFZgDuz.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./@emotion-BtrR-yrm.js";import"./stylis-D5iaQeiq.js";import"./scroll-into-view-if-needed-SxpMpKWN.js";import"./compute-scroll-into-view-1gs_hJI2.js";import"./vue-types-99Xd1yP8.js";import"./dom-align-CRCehRfe.js";import"./lodash-es-DnYq9fPm.js";import"./async-validator-CRx4dHSJ.js";import"./throttle-debounce-CUWDS_la.js";function re(s){return g.post("/manager/teacher/edit",s)}function le(s){return g.get("/manager/teacher/delete",{params:{teacherId:s}})}function oe(s,y,i){return g.post(`/manager/teacher/list/${s}/${y}`,i)}function ne(s){return g.get("/manager/class/getClassByUniversityId",{params:{universityId:s}})}function se(s){return g.get("/manager/course/getCourseByUniversityId",{params:{universityId:s}})}const ue=E({__name:"TeacherComp",setup(s){const y=ae(),i=U([]),D=U([]),m=S({current:1,pageSize:10,total:0,showTotal:t=>`共 ${t} 条`}),h=S({teacherNo:"",teacherName:"",teacherGender:""}),M=U([]),F=[{title:"教师编号",dataIndex:"teacherNo",key:"teacherNo"},{title:"姓名",dataIndex:"teacherName",key:"teacherName"},{title:"生日",dataIndex:"teacherBirthday",key:"teacherBirthday"},{title:"性别",dataIndex:"teacherGender",key:"teacherGender"},{title:"班级与课程",dataIndex:"teacherOwnerClassCourse",key:"courses"},{title:"操作",key:"actions",width:150}],f=U(!1),l=S({teacherId:0,teacherNo:"",teacherName:"",teacherBirthday:null,teacherGender:"",selectClassCourse:[]}),C=async()=>{try{const t=await oe(m.current,m.pageSize,h);i.value=t.records,m.total=t.total}catch{v.error("加载教师列表失败")}},V=async()=>{try{const t=await ne(y.loginUserInfo?.universityId);M.value=t.map(e=>({label:e.className,value:e.classId}))}catch{v.error("班级数据加载失败")}},O=()=>{m.current=1,C()},L=t=>{m.current=t.current,m.pageSize=t.pageSize,C()},j=t=>{console.log(t),l.teacherId=t.teacherId,l.teacherNo=t.teacherNo,l.teacherName=t.teacherName,l.teacherGender=t.teacherGender,l.teacherBirthday=t.teacherBirthday?ee(t.teacherBirthday):null,l.selectClassCourse=t.teacherOwnerClassCourse,f.value=!0},q=async()=>{try{await re({teacherId:l.teacherId,teacherNo:l.teacherNo,teacherName:l.teacherName,teacherGender:l.teacherGender,teacherBirthday:l.teacherBirthday?l.teacherBirthday.format("YYYY-MM-DD"):null,selectClassCourse:l.selectClassCourse}),v.success("编辑成功"),f.value=!1,C()}catch{v.error("编辑失败")}},P=async()=>{try{const t=await se(y.loginUserInfo?.universityId);console.log(t,"res"),D.value=t.map(e=>({label:e.courseName,value:e.id}))}catch{v.error("课程数据加载失败")}},Z=()=>{f.value=!1},A=t=>{te.confirm({title:"确认删除该教师吗？",async onOk(){try{await le(t),v.success("删除成功"),C()}catch{v.error("删除失败")}}})};return W(()=>{C(),V(),P()}),(t,e)=>{const I=n("a-input"),p=n("a-form-item"),w=n("a-select-option"),B=n("a-select"),N=n("a-button"),T=n("a-form"),H=n("a-tag"),Y=n("a-space"),J=n("a-table"),K=n("a-date-picker"),Q=n("a-card"),R=n("a-modal");return c(),k("div",null,[a(T,{layout:"inline",onSubmit:X(O,["prevent"])},{default:r(()=>[a(p,{label:"教师编号"},{default:r(()=>[a(I,{value:h.teacherNo,"onUpdate:value":e[0]||(e[0]=o=>h.teacherNo=o),placeholder:"请输入教师编号","allow-clear":""},null,8,["value"])]),_:1}),a(p,{label:"教师姓名"},{default:r(()=>[a(I,{value:h.teacherName,"onUpdate:value":e[1]||(e[1]=o=>h.teacherName=o),placeholder:"请输入教师姓名","allow-clear":""},null,8,["value"])]),_:1}),a(p,{label:"性别"},{default:r(()=>[a(B,{value:h.teacherGender,"onUpdate:value":e[2]||(e[2]=o=>h.teacherGender=o),placeholder:"选择性别","allow-clear":"",style:{width:"120px"}},{default:r(()=>[a(w,{value:"男"},{default:r(()=>e[9]||(e[9]=[u("男",-1)])),_:1,__:[9]}),a(w,{value:"女"},{default:r(()=>e[10]||(e[10]=[u("女",-1)])),_:1,__:[10]})]),_:1},8,["value"])]),_:1}),a(p,null,{default:r(()=>[a(N,{type:"primary",onClick:O},{default:r(()=>e[11]||(e[11]=[u("查询",-1)])),_:1,__:[11]})]),_:1})]),_:1}),a(J,{columns:F,"data-source":i.value,pagination:m,"row-key":"teacherId",bordered:"",onChange:L,style:{"margin-top":"16px"}},{bodyCell:r(({column:o,record:_})=>[o.key==="courses"?(c(),b(Y,{key:0,wrap:""},{default:r(()=>[(c(!0),k(x,null,z(_.teacherOwnerClassCourse,d=>(c(),b(H,{key:`${d.classId}-${d.courseId}`},{default:r(()=>[u($(d.className)+" - "+$(d.courseName),1)]),_:2},1024))),128))]),_:2},1024)):o.key==="actions"?(c(),b(Y,{key:1},{default:r(()=>[a(N,{type:"link",onClick:d=>j(_)},{default:r(()=>e[12]||(e[12]=[u("编辑",-1)])),_:2,__:[12]},1032,["onClick"]),a(N,{type:"link",danger:"",onClick:d=>A(_.teacherId)},{default:r(()=>e[13]||(e[13]=[u("删除",-1)])),_:2,__:[13]},1032,["onClick"])]),_:2},1024)):(c(),k(x,{key:2},[u($(_[o.dataIndex]),1)],64))]),_:1},8,["data-source","pagination"]),a(R,{open:f.value,"onUpdate:open":e[8]||(e[8]=o=>f.value=o),title:"编辑教师",onOk:q,onCancel:Z,destroyOnClose:""},{default:r(()=>[a(T,{model:l,"label-col":{span:5},"wrapper-col":{span:16}},{default:r(()=>[a(p,{label:"教师编号"},{default:r(()=>[a(I,{value:l.teacherNo,"onUpdate:value":e[3]||(e[3]=o=>l.teacherNo=o)},null,8,["value"])]),_:1}),a(p,{label:"姓名"},{default:r(()=>[a(I,{value:l.teacherName,"onUpdate:value":e[4]||(e[4]=o=>l.teacherName=o)},null,8,["value"])]),_:1}),a(p,{label:"生日"},{default:r(()=>[a(K,{value:l.teacherBirthday,"onUpdate:value":e[5]||(e[5]=o=>l.teacherBirthday=o),style:{width:"100%"}},null,8,["value"])]),_:1}),a(p,{label:"性别"},{default:r(()=>[a(B,{value:l.teacherGender,"onUpdate:value":e[6]||(e[6]=o=>l.teacherGender=o),style:{width:"100%"}},{default:r(()=>[a(w,{value:"男"},{default:r(()=>e[14]||(e[14]=[u("男",-1)])),_:1,__:[14]}),a(w,{value:"女"},{default:r(()=>e[15]||(e[15]=[u("女",-1)])),_:1,__:[15]})]),_:1},8,["value"])]),_:1}),e[18]||(e[18]=G("div",null," 教师授课情况 ",-1)),(c(!0),k(x,null,z(l.selectClassCourse,(o,_)=>(c(),b(Q,null,{default:r(()=>[G("div",null,[a(B,{value:o.classId,"onUpdate:value":d=>o.classId=d,"show-search":"",options:M.value,placeholder:"选择教师的班级",style:{width:"200px"}},null,8,["value","onUpdate:value","options"]),a(B,{value:o.courseId,"onUpdate:value":d=>o.courseId=d,"show-search":"",options:D.value,placeholder:"选择教师的课程",style:{width:"200px"}},null,8,["value","onUpdate:value","options"]),a(N,{onClick:()=>l.selectClassCourse.splice(_,1)},{default:r(()=>e[16]||(e[16]=[u("删除",-1)])),_:2,__:[16]},1032,["onClick"])])]),_:2},1024))),256)),a(N,{onClick:e[7]||(e[7]=()=>l.selectClassCourse.push({className:"",courseName:""}))},{default:r(()=>e[17]||(e[17]=[u("新增",-1)])),_:1,__:[17]})]),_:1,__:[18]},8,["model"])]),_:1},8,["open"])])}}}),Se=E({__name:"PeopleManage",setup(s){return(y,i)=>(c(),k(x,null,[i[0]||(i[0]=G("div",{class:"ant-h2-title"}," 教师管理 ",-1)),a(ue),i[1]||(i[1]=G("div",{class:"ant-h2-title"}," 学生管理 ",-1))],64))}});export{Se as default};

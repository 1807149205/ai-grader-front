import{m as p}from"./managerAPI-DjYLhOFN.js";import{u as L}from"./index-bE28JWhL.js";import{a as x}from"./ant-design-vue-BsThXQyf.js";import{d as V,a as S,r as _,o as q,a2 as j,F as C,c as a,Z as l,$ as t,_ as f,G as g,Y as M,a5 as T,a3 as G,a1 as P,a0 as F}from"./@vue-DQ8ziMgL.js";import"./http-DtPS8xaZ.js";import"./axios-NIGUFBhG.js";import"./pinia-uvDSw88s.js";import"./vue-router-Bnt47Z6A.js";import"./@babel-Bq4_u9L9.js";import"./@ant-design-DeQVn8T2.js";import"./@ctrl-DOFZgDuz.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./@emotion-BtrR-yrm.js";import"./stylis-D5iaQeiq.js";import"./scroll-into-view-if-needed-SxpMpKWN.js";import"./compute-scroll-into-view-1gs_hJI2.js";import"./vue-types-99Xd1yP8.js";import"./dom-align-CRCehRfe.js";import"./lodash-es-DnYq9fPm.js";import"./dayjs-Ct77qKTJ.js";import"./async-validator-CRx4dHSJ.js";import"./throttle-debounce-CUWDS_la.js";const Y=V({__name:"CollegeComp",setup(B){const y=[{title:"id",dataIndex:"id",key:"id"},{title:"学院名称",dataIndex:"collegeName",key:"collegeName"},{title:"创建时间",dataIndex:"createDate",key:"createDate"},{title:"更新时间",dataIndex:"updateDate",key:"updateDate"},{title:"操作",dataIndex:"action",key:"action"}],e=S({collegeId:"",collegeName:""}),u=_(!1),n=_(!1),m=L(),v=_([]),k=d=>{n.value=!0,u.value=!0,e.collegeId=d.id,e.collegeName=d.collegeName},D=async()=>{try{if(n.value){await p.editCollege({collegeId:e.collegeId,collegeName:e.collegeName});return}else await p.addCollege({collegeName:e.collegeName,universityId:m.loginUserInfo?.universityId});x.success(`${n.value?"编辑":"新增"}成功`)}catch(d){console.error(d),x.error(`${n.value?"编辑":"新增"}失败`)}finally{u.value=!1,await I()}},I=async()=>{v.value=await p.collegeList(m.loginUserInfo?.universityId)};return q(()=>{I()}),(d,r)=>{const i=l("a-button"),o=l("a-space"),N=l("a-table"),b=l("a-input"),w=l("a-form-item"),U=l("a-form"),$=l("a-modal");return f(),j(C,null,[a(o,null,{default:t(()=>[a(i,{type:"primary",onClick:r[0]||(r[0]=()=>{n.value=!1,u.value=!0})},{default:t(()=>r[3]||(r[3]=[g("新增学院",-1)])),_:1,__:[3]})]),_:1}),a(N,{columns:y,"data-source":v.value,"row-key":"id"},{bodyCell:t(({column:c,record:O})=>[c.key==="action"?(f(),M(o,{key:0},{default:t(()=>[a(i,{type:"link",onClick:E=>k(O)},{default:t(()=>r[4]||(r[4]=[g("编辑",-1)])),_:2,__:[4]},1032,["onClick"])]),_:2},1024)):T("",!0)]),_:1},8,["data-source"]),a($,{open:u.value,"onUpdate:open":r[2]||(r[2]=c=>u.value=c),title:n.value?"编辑学院":"新增学院","ok-text":"确认","cancel-text":"取消",onOk:D},{default:t(()=>[a(U,{"label-col":{span:4},"wrapper-col":{span:14}},{default:t(()=>[a(w,{label:"学院名称",name:"collegeName",rules:[{required:!0,message:"请输入学院名称"}]},{default:t(()=>[a(b,{value:e.collegeName,"onUpdate:value":r[1]||(r[1]=c=>e.collegeName=c),placeholder:"请输入学院名称"},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["open","title"])],64)}}}),Z=V({__name:"MajorComp",setup(B){const y=[{title:"id",dataIndex:"id",key:"id"},{title:"学院名称",dataIndex:"collegeName",key:"collegeName"},{title:"专业名称",dataIndex:"majorName",key:"majorName"},{title:"创建时间",dataIndex:"createDate",key:"createDate"},{title:"更新时间",dataIndex:"updateDate",key:"updateDate"},{title:"操作",dataIndex:"action",key:"action"}],e=S({majorId:"",majorName:"",collegeId:""}),u=_([]),n=_(!1),m=_(!1),v=L(),k=_([]),D=i=>{m.value=!0,n.value=!0,e.majorId=i.id,e.majorName=i.collegeName},I=async()=>{try{if(m.value){await p.majorEdit({majorId:e.majorId,majorName:e.majorName});return}else await p.addMajor({majorName:e.majorName,collegeId:e.collegeId});x.success(`${m.value?"编辑":"新增"}成功`)}catch(i){console.error(i),x.error(`${m.value?"编辑":"新增"}失败`)}finally{n.value=!1,await d()}},d=async()=>{k.value=await p.majorList(v.loginUserInfo?.universityId)},r=async()=>{const i=await p.collegeList(v.loginUserInfo?.universityId);u.value=i.map(o=>({label:o.collegeName,value:o.id}))};return q(()=>{d(),r()}),(i,o)=>{const N=l("a-button"),b=l("a-space"),w=l("a-table"),U=l("a-select-option"),$=l("a-select"),c=l("a-form-item"),O=l("a-input"),E=l("a-form"),H=l("a-modal");return f(),j(C,null,[a(b,null,{default:t(()=>[a(N,{type:"primary",onClick:o[0]||(o[0]=()=>{m.value=!1,n.value=!0})},{default:t(()=>o[4]||(o[4]=[g("新增专业",-1)])),_:1,__:[4]})]),_:1}),a(w,{columns:y,"data-source":k.value,"row-key":"id"},{bodyCell:t(({column:s,record:A})=>[s.key==="action"?(f(),M(b,{key:0},{default:t(()=>[a(N,{type:"link",onClick:z=>D(A)},{default:t(()=>o[5]||(o[5]=[g("编辑",-1)])),_:2,__:[5]},1032,["onClick"])]),_:2},1024)):T("",!0)]),_:1},8,["data-source"]),a(H,{open:n.value,"onUpdate:open":o[3]||(o[3]=s=>n.value=s),title:m.value?"编辑专业":"新增专业","ok-text":"确认","cancel-text":"取消",onOk:I},{default:t(()=>[a(E,{"label-col":{span:6},"wrapper-col":{span:16}},{default:t(()=>[a(c,{label:"专业所属学院",name:"collegeId",rules:[{required:!0,message:"请选择所属学院"}]},{default:t(()=>[a($,{value:e.collegeId,"onUpdate:value":o[1]||(o[1]=s=>e.collegeId=s),placeholder:"请选择专业所属学院"},{default:t(()=>[(f(!0),j(C,null,G(u.value,s=>(f(),M(U,{key:s.value,value:s.value},{default:t(()=>[g(P(s.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),a(c,{label:"专业名称",name:"majorName",rules:[{required:!0,message:"请输入专业名称"}]},{default:t(()=>[a(O,{value:e.majorName,"onUpdate:value":o[2]||(o[2]=s=>e.majorName=s),placeholder:"请输入专业名称"},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["open","title"])],64)}}}),fe=V({__name:"UniversityManage",setup(B){return(y,e)=>(f(),j(C,null,[e[0]||(e[0]=F("div",{class:"ant-h2-title"},"学院管理",-1)),a(Y),e[1]||(e[1]=F("div",{class:"ant-h2-title"},"专业管理",-1)),a(Z)],64))}});export{fe as default};
